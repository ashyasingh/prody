{"ast":null,"code":"import _slicedToArray from \"/Users/michellezyman/Projects/prody/prody-master/prody_fe/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/michellezyman/Projects/prody/prody-master/prody_fe/src/App.js\";\nimport React, { useEffect, useState } from 'react';\nimport './App.css';\nimport { BrowserRouter, Route, Switch, Redirect } from 'react-router-dom';\nimport { AppContext } from './AppContext';\nimport Login from './Login/Login';\nimport Console from './Console/Console';\n\nconst App = () => {\n  // const companySession = localStorage.getItem('company');\n  // const [company, setCompany] = useState(companySession);\n  const _useState = useState(!!JSON.parse(localStorage.getItem('user'))),\n        _useState2 = _slicedToArray(_useState, 2),\n        isLoggedIn = _useState2[0],\n        setIsLoggedIn = _useState2[1];\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const userStorage = JSON.parse(localStorage.getItem('user'));\n      const now = Date.now();\n      console.log(`app ${isLoggedIn}`);\n\n      if (isLoggedIn) {\n        if (!userStorage || now > userStorage.expireAt) {\n          setIsLoggedIn(false);\n          localStorage.clear();\n        }\n      }\n    }, 10 * 60 * 1000); // 10 min\n\n    return () => clearInterval(interval);\n  }, []);\n\n  const routes = () => {\n    if (!isLoggedIn) {\n      return React.createElement(Switch, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 33\n        },\n        __self: this\n      }, React.createElement(Route, {\n        path: \"/login\",\n        component: Login,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 34\n        },\n        __self: this\n      }), React.createElement(Redirect, {\n        to: {\n          pathname: '/login'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35\n        },\n        __self: this\n      }));\n    } else {\n      return React.createElement(Switch, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 39\n        },\n        __self: this\n      }, React.createElement(Route, {\n        path: \"/\",\n        component: Console,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }), React.createElement(Redirect, {\n        to: {\n          pathname: '/'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 41\n        },\n        __self: this\n      }));\n    }\n  }; // console.log(`app rendered`);\n\n\n  return React.createElement(\"div\", {\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  }, React.createElement(BrowserRouter, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51\n    },\n    __self: this\n  }, React.createElement(AppContext.Provider, {\n    value: {\n      isLoggedIn,\n      setIsLoggedIn\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }, routes())), React.createElement(\"div\", {\n    className: \"footer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }, \"Prody (C) All rights reserved\"));\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/michellezyman/Projects/prody/prody-master/prody_fe/src/App.js"],"names":["React","useEffect","useState","BrowserRouter","Route","Switch","Redirect","AppContext","Login","Console","App","JSON","parse","localStorage","getItem","isLoggedIn","setIsLoggedIn","interval","setInterval","userStorage","now","Date","console","log","expireAt","clear","clearInterval","routes","pathname"],"mappings":";;AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,QAA1B,QAAyC,OAAzC;AACA,OAAO,WAAP;AACA,SAAQC,aAAR,EAAuBC,KAAvB,EAA8BC,MAA9B,EAAsCC,QAAtC,QAAqD,kBAArD;AAEA,SAASC,UAAT,QAA2B,cAA3B;AACA,OAAOC,KAAP,MAAkB,eAAlB;AACA,OAAOC,OAAP,MAAoB,mBAApB;;AAEA,MAAMC,GAAG,GAAG,MAAM;AAEd;AACA;AAHc,oBAIsBR,QAAQ,CAAC,CAAC,CAACS,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAH,CAJ9B;AAAA;AAAA,QAIPC,UAJO;AAAA,QAIKC,aAJL;;AAMdf,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMgB,QAAQ,GAAGC,WAAW,CAAC,MAAM;AAC/B,YAAMC,WAAW,GAAGR,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAApB;AACA,YAAMM,GAAG,GAAGC,IAAI,CAACD,GAAL,EAAZ;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAa,OAAMR,UAAW,EAA9B;;AACA,UAAIA,UAAJ,EAAgB;AACZ,YAAI,CAACI,WAAD,IAAgBC,GAAG,GAAGD,WAAW,CAACK,QAAtC,EAAgD;AAC5CR,UAAAA,aAAa,CAAC,KAAD,CAAb;AACAH,UAAAA,YAAY,CAACY,KAAb;AACH;AACJ;AACJ,KAV2B,EAUzB,KAAG,EAAH,GAAM,IAVmB,CAA5B,CADY,CAWI;;AAChB,WAAO,MAAMC,aAAa,CAACT,QAAD,CAA1B;AACH,GAbQ,EAaN,EAbM,CAAT;;AAeA,QAAMU,MAAM,GAAG,MAAM;AACjB,QAAI,CAACZ,UAAL,EAAiB;AACb,aACI,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,KAAD;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAqB,QAAA,SAAS,EAAEP,KAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAEI,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAE;AAAEoB,UAAAA,QAAQ,EAAE;AAAZ,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFJ,CADJ;AAKE,KANN,MAOK;AAAC,aACF,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,KAAD;AAAO,QAAA,IAAI,EAAC,GAAZ;AAAgB,QAAA,SAAS,EAAEnB,OAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAEI,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAE;AAAEmB,UAAAA,QAAQ,EAAE;AAAZ,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFJ,CADE;AAKJ;AAEL,GAfD,CArBc,CAsCd;;;AAEA,SACQ;AAAK,IAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,UAAD,CAAY,QAAZ;AAAqB,IAAA,KAAK,EAAE;AAAEb,MAAAA,UAAF;AAAcC,MAAAA;AAAd,KAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACCW,MAAM,EADP,CADJ,CADJ,EAMI;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCANJ,CADR;AAYH,CApDD;;AAsDA,eAAejB,GAAf","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport './App.css';\nimport {BrowserRouter, Route, Switch, Redirect} from 'react-router-dom';\n\nimport { AppContext } from './AppContext';\nimport Login from './Login/Login';\nimport Console from './Console/Console';\n\nconst App = () => {\n\n    // const companySession = localStorage.getItem('company');\n    // const [company, setCompany] = useState(companySession);\n    const [isLoggedIn, setIsLoggedIn] = useState(!!JSON.parse(localStorage.getItem('user')));\n\n    useEffect(() => {\n        const interval = setInterval(() => {\n            const userStorage = JSON.parse(localStorage.getItem('user'));\n            const now = Date.now();\n            console.log(`app ${isLoggedIn}`);\n            if (isLoggedIn) {\n                if (!userStorage || now > userStorage.expireAt) {\n                    setIsLoggedIn(false);\n                    localStorage.clear();\n                }\n            }\n        }, 10*60*1000); // 10 min\n        return () => clearInterval(interval);\n    }, []);\n\n    const routes = () => {\n        if (!isLoggedIn) {\n            return (\n                <Switch>\n                    <Route path=\"/login\" component={Login}/>\n                    <Redirect to={{ pathname: '/login'}} />\n                </Switch>\n            )}\n        else {return (\n            <Switch>\n                <Route path=\"/\" component={Console} />\n                <Redirect to={{ pathname: '/'}} />\n            </Switch>\n        )}\n\n    };\n\n    // console.log(`app rendered`);\n\n    return (\n            <div className=\"App\">\n                <BrowserRouter>\n                    <AppContext.Provider value={{ isLoggedIn, setIsLoggedIn }}>\n                    {routes()}\n                    </AppContext.Provider>\n                </BrowserRouter>\n                <div className=\"footer\">\n                    Prody (C) All rights reserved\n                </div>\n            </div>\n    );\n};\n\nexport default App;"]},"metadata":{},"sourceType":"module"}